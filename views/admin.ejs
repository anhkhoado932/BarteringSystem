<!DOCTYPE html>
<html lang="en">

<%- include("partials/header.ejs", {title: "Bartering System" }) %>

    <body>
        <div class="container">
            <% if (message) { %>
                <div class="alert temp-message" style="background-color: green; text-align: center;">
                    <%= message %>
                </div>
                <% } %>
                    <div id="message" style="display: none;"></div>
                    <%- include("partials/navbar") %>

                        <h1 class="my-5">Admin Panel</h1>

                        <!-- User Management Section -->
                        <h2 class="my-4">User Management</h2>
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Username</th>
                                    <th>Email</th>
                                    <th>Role</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% users.forEach(user=> { %>
                                    <tr>
                                        <td>
                                            <%= user.name %>
                                        </td>
                                        <td>
                                            <%= user.email %>
                                        </td>
                                        <td>
                                            <%= user.role %>
                                        </td>
                                        <td>
                                            <button class="btn btn-secondary edit-user-btn me-1"
                                                data-user-id="<%= user._id %>">Edit</button>
                                            <button class="btn btn-danger delete-user-btn" data-item="user"
                                                data-user-id="<%= user._id %>">Delete</button>
                                        </td>
                                    </tr>
                                    <% }); %>
                            </tbody>
                        </table>

                        <!-- Product Management Section -->
                        <h2 class="my-4">Product Management</h2>
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Product Name</th>
                                    <th>Image</th>
                                    <th>Price</th>
                                    <th>Details</th>
                                    <th style="width: 200px;">Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% products.forEach(product=> { %>
                                    <tr>
                                        <td>
                                            <%= product.name %>
                                        </td>
                                        <td><img src="<%= product.imageUrl %>" width="100"></td>
                                        <td>
                                            <%= product.price %>
                                        </td>
                                        <td>
                                            <%= product.details %>
                                        </td>
                                        <td>
                                            <button class="btn btn-secondary edit-product-btn me-1"
                                                data-product-id="<%= product._id %>">Edit</button>
                                            <button class="btn btn-danger delete-product-btn" data-item="product"
                                                data-product-id="<%= product._id %>">Delete</button>
                                        </td>
                                    </tr>
                                    <% }); %>
                            </tbody>
                        </table>

                        <!-- Feedback Management Section -->
                        <h2>All Feedbacks</h2>
                        <table class="table table-striped">
                            <tr>
                                <th>ID</th>
                                <th>Email</th>
                                <th>Name</th>
                                <th>Phone</th>
                                <th>Message</th>
                                <th>Date</th>
                                <th>Delete</th>
                            </tr>
                            <% feedbacks.forEach((feedback)=> { %>
                                <tr>
                                    <td>
                                        <%= feedback._id %>
                                    </td>
                                    <td>
                                        <%= feedback.email %>
                                    </td>
                                    <td>
                                        <%= feedback.name %>
                                    </td>
                                    <td>
                                        <%= feedback.phone %>
                                    </td>
                                    <td>
                                        <%= feedback.message %>
                                    </td>
                                    <td>
                                        <%= feedback.createdAt %>
                                    </td>
                                    <td>
                                        <button class="btn btn-danger delete-feedback-btn" data-item="feedback"
                                            data-feedback-id="<%= feedback._id %>">Delete</button>
                                    </td>
                                </tr>
                                <% }) %>
                        </table>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
            crossorigin="anonymous"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"
            integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
        <script src="/js/script.js"></script>
        <script src="/js/navbar.js"></script>
    </body>

    <%- include("partials/footer.ejs") %>

</html>